<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>网络寻租</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="author" content="halida" />
    <link rel="alternate" type="application/rss+xml" title="网络寻租 - RSS" href="http://blog.linjunhalida.com/feed" />
    <link href="/stylesheets/pygments-default.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/site.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/jquery.js" type="text/javascript"></script>
  </head>
  <body class='color-4'>
    <div id='warper'>
      <nav>
        <div id='container'>
          <ul class='first-nav'>
            <li>
              <a href="/">网络寻租</a>
            </li>
            <li>
              <a href="/list.html">列表</a>
            </li>
            <li>
              <a href="/about.html">关于</a>
            </li>
          </ul>
          <ul class='secondary-nav'>
            <li>
              <a href="/feed.xml">feed</a>
            </li>
          </ul>
          <select id='color-select'>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
          </select>
        </div>
      </nav>
      <div id='block-nav'></div>
      <div id='content'>
        <div class='article'>
          <g:plusone></g:plusone>
          <script type='text/javascript'>
            //<![CDATA[
              window.___gcfg = {lang: 'zh-CN'};
              (function() {
                var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
              })();
            //]]>
          </script>
          <h1 class='article-title'>pyqt介绍</h1>
          <div class="document" id="gui-pyqt4">
          <h1 class="title">最强大的GUI库 -- PyQt4</h1>
          <table class="docinfo" frame="void" rules="none">
          <col class="docinfo-name" />
          <col class="docinfo-content" />
          <tbody valign="top">
          <tr><th class="docinfo-name">Authors:</th>
          <td>机械唯物主义 &lt;linjunhalida&#64;gmai.com&gt;</td></tr>
          <tr><th class="docinfo-name">Date:</th>
          <td>2010-11-09</td></tr>
          </tbody>
          </table>
          <!-- Definitions of interpreted text roles (classes) for S5/HTML data. -->
          <!-- This data file has been placed in the public domain. -->
          <!-- Colours
          ======= -->
          <!-- Text Sizes
          ========== -->
          <!-- Display in Slides (Presentation Mode) Only
          ========================================== -->
          <!-- Display in Outline Mode Only
          ============================ -->
          <!-- Display in Print Only
          ===================== -->
          <!-- Display in Handout Mode Only
          ============================ -->
          <!-- Incremental Display
          =================== -->
          <div class="handout container">
          PyQt4是我见到过的最好用的GUI开发库, 具体不多讲, 直接上例子.</div>
          <div class="contents handout topic" id="contents">
          <p class="topic-title first">Contents</p>
          <ul class="simple">
          <li><a class="reference internal" href="#id1" id="id10">一个简单的实例</a></li>
          <li><a class="reference internal" href="#id2" id="id11">代码</a></li>
          <li><a class="reference internal" href="#id3" id="id12">类层级</a></li>
          <li><a class="reference internal" href="#layout" id="id13">layout</a></li>
          <li><a class="reference internal" href="#id4" id="id14">layout</a></li>
          <li><a class="reference internal" href="#signal-and-slot-in-qt" id="id15">Signal and Slot in Qt</a></li>
          <li><a class="reference internal" href="#qtpyqt" id="id16">Qt和PyQt 事件机制区别</a></li>
          <li><a class="reference internal" href="#id5" id="id17">一个复杂的实例: 扫雷</a></li>
          <li><a class="reference internal" href="#ui-designer" id="id18">UI designer</a></li>
          <li><a class="reference internal" href="#ui-with-code" id="id19">UI with Code</a></li>
          <li><a class="reference internal" href="#event" id="id20">Event</a></li>
          <li><a class="reference internal" href="#id6" id="id21">其他强大特性</a></li>
          <li><a class="reference internal" href="#id7" id="id22">发布</a></li>
          <li><a class="reference internal" href="#id9" id="id23">资源</a></li>
          </ul>
          </div>
          <div class="section" id="id1">
          <h1><a class="toc-backref" href="#id10">一个简单的实例</a></h1>
          <ul class="incremental simple">
          <li>计算器</li>
          <li>10分钟</li>
          </ul>
          <img alt="http://lh6.ggpht.com/_os_zrveP8Ns/TNnrsk8C64I/AAAAAAAADMc/TMTjkv1is7k/s800/caculator_ui.png" src="http://lh6.ggpht.com/_os_zrveP8Ns/TNnrsk8C64I/AAAAAAAADMc/TMTjkv1is7k/s800/caculator_ui.png" />
          <p class="handout">pyqt实现一个简单的计算器界面, 只需要10分钟.</p>
          </div>
          <div class="section" id="id2">
          <h1><a class="toc-backref" href="#id11">代码</a></h1>
          <img alt="http://lh3.ggpht.com/_os_zrveP8Ns/TNnooDH5dtI/AAAAAAAADLo/KK7FwKekTRo/s800/caculator.JPG" src="http://lh3.ggpht.com/_os_zrveP8Ns/TNnooDH5dtI/AAAAAAAADLo/KK7FwKekTRo/s800/caculator.JPG" />
          <p class="handout">这个是计算器的代码:</p>
          <div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
          <span class="c">#-*- coding:utf-8 -*-</span>
          <span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="o">*</span>
          <span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="o">*</span>
          
          <span class="k">class</span> <span class="nc">Caculator</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
              <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                  <span class="nb">super</span><span class="p">(</span><span class="n">Caculator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
                  <span class="c">#widgets</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">leInput</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">lwResult</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
                  <span class="c">#layouts</span>
                  <span class="n">l</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lwResult</span><span class="p">:</span>
                      <span class="n">l</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                  <span class="c">#events</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caculate</span><span class="p">)</span>
          
              <span class="k">def</span> <span class="nf">caculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                  <span class="n">data</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                  <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
          
                  <span class="k">try</span><span class="p">:</span>
                      <span class="n">result</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                      <span class="n">result</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
          
                  <span class="bp">self</span><span class="o">.</span><span class="n">lwResult</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
          
          
          <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
              <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">([])</span>
              <span class="n">Caculator</span><span class="p">()</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
          
          <span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&quot;__main__&quot;</span><span class="p">:</span>
              <span class="n">main</span><span class="p">()</span>
          </pre></div>
          </div>
          <div class="section" id="id3">
          <h1><a class="toc-backref" href="#id12">类层级</a></h1>
          <pre class="literal-block">
          QObject
             |----- QWidget
                       |----- QDialog
                       |----- QLineEdit
                       |----- QListWidget
          </pre>
          <p class="handout">以及计算器这个界面的控件是如何组织的.</p>
          </div>
          <div class="section" id="layout">
          <h1><a class="toc-backref" href="#id13">layout</a></h1>
          <img alt="http://lh3.ggpht.com/_os_zrveP8Ns/TNnoon5j6aI/AAAAAAAADLw/ITJ9fVU9YtE/s800/layout.JPG" src="http://lh3.ggpht.com/_os_zrveP8Ns/TNnoon5j6aI/AAAAAAAADLw/ITJ9fVU9YtE/s800/layout.JPG" />
          <p class="handout">qt采用非常简洁的方式来组织界面.
          只需要设置子控件是如何在父控件上面排列的, qt自动帮你调整好大小.</p>
          </div>
          <div class="section" id="id4">
          <h1><a class="toc-backref" href="#id14">layout</a></h1>
          <ul>
          <li><p class="first">层级:</p>
          <pre class="literal-block">
          QDialog (QVBoxLayout)
             |----- QLineEdit
             |----- QListWidget
          </pre>
          </li>
          <li><p class="first">代码:</p>
          </li>
          </ul>
          <div class="highlight"><pre><span class="n">l</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lwResult</span><span class="p">:</span>
              <span class="n">l</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
          </pre></div>
          </div>
          <div class="section" id="signal-and-slot-in-qt">
          <h1><a class="toc-backref" href="#id15">Signal and Slot in Qt</a></h1>
          <img alt="http://lh4.ggpht.com/_os_zrveP8Ns/TNnoo68TzKI/AAAAAAAADL4/jPjbRhwQEI8/s800/signal_and_slot.JPG" src="http://lh4.ggpht.com/_os_zrveP8Ns/TNnoo68TzKI/AAAAAAAADL4/jPjbRhwQEI8/s800/signal_and_slot.JPG" />
          <p class="handout">至于消息如何传递的呢? 只需要把一个消息链接到处理的方法上面就好了.</p>
          </div>
          <div class="section" id="qtpyqt">
          <h1><a class="toc-backref" href="#id16">Qt和PyQt 事件机制区别</a></h1>
          <ul class="simple">
          <li>Qt:</li>
          </ul>
          <div class="highlight"><pre><span class="k">this</span><span class="o">-&gt;</span><span class="n">connect</span><span class="p">(</span><span class="n">leInput</span><span class="p">,</span> <span class="n">SINGAL</span><span class="p">(</span><span class="n">returnPressed</span><span class="p">()),</span> <span class="k">this</span><span class="p">,</span> <span class="n">caculate</span><span class="p">))</span>
          </pre></div>
          <ul class="simple">
          <li>PyQt:</li>
          </ul>
          <div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">leInput</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caculate</span><span class="p">)</span>
          </pre></div>
          <p class="handout">pyqt比qt要简单得多, pythonic!</p>
          </div>
          <div class="section" id="id5">
          <h1><a class="toc-backref" href="#id17">一个复杂的实例: 扫雷</a></h1>
          <ul class="simple">
          <li>花费时间: 2个晚上, 基础:2.5小时, 一点点提升:1小时</li>
          <li>扫雷下载: <a class="reference external" href="https://bitbucket.org/linjunhalida/pyqtmine/">pyqtmine</a></li>
          </ul>
          <img alt="http://lh6.ggpht.com/_os_zrveP8Ns/TNnoooQuryI/AAAAAAAADL0/MLwyt5qromk/s800/pyqtmine.JPG" src="http://lh6.ggpht.com/_os_zrveP8Ns/TNnoooQuryI/AAAAAAAADL0/MLwyt5qromk/s800/pyqtmine.JPG" />
          <p class="handout">上面是基础的一些概念, 我们深入一些, 看看更复杂的例子. 比如一个扫雷的程序(其实也很简单)</p>
          </div>
          <div class="section" id="ui-designer">
          <h1><a class="toc-backref" href="#id18">UI designer</a></h1>
          <img alt="http://lh4.ggpht.com/_os_zrveP8Ns/TNnoodk5clI/AAAAAAAADLs/cbHdyQCMco8/s800/designer.JPG" src="http://lh4.ggpht.com/_os_zrveP8Ns/TNnoodk5clI/AAAAAAAADLs/cbHdyQCMco8/s800/designer.JPG" />
          <p class="handout">自己写UI是不是太复杂了? 拖拖拉拉不是更好? qt提供了这样的一个工具.
          非常好用! 可以和tk/wxpython等说再见了!</p>
          </div>
          <div class="section" id="ui-with-code">
          <h1><a class="toc-backref" href="#id19">UI with Code</a></h1>
          <div class="highlight"><pre><span class="n">form</span><span class="p">,</span> <span class="n">base</span> <span class="o">=</span> <span class="n">uic</span><span class="o">.</span><span class="n">loadUiType</span><span class="p">(</span><span class="s">&quot;score.ui&quot;</span><span class="p">)</span>
          <span class="k">class</span> <span class="nc">ScoreDlg</span><span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
              <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                  <span class="nb">super</span><span class="p">(</span><span class="n">ScoreDlg</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
          </pre></div>
          <p class="handout">写好score.ui之后, 需要补充后面的逻辑, 把ui转换成class, 然后继承就好了.</p>
          </div>
          <div class="section" id="event">
          <h1><a class="toc-backref" href="#id20">Event</a></h1>
          <div class="highlight"><pre><span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
              <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">:</span>
                  <span class="o">...</span>
          
          <span class="k">def</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
              <span class="n">p</span> <span class="o">=</span> <span class="n">QPainter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
              <span class="o">...</span>
              <span class="n">p</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">mx</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">sx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">mx</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">sx</span><span class="p">,</span> <span class="n">my</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">sy</span><span class="p">)</span>
          </pre></div>
          <p class="handout">不是所有的时间机制都可以用signal&amp;slot解决的, 有些事件, 只能通过重载来解决.
          比如上面鼠标和画图事件, 必须重载对应的处理函数.</p>
          </div>
          <div class="section" id="id6">
          <h1><a class="toc-backref" href="#id21">其他强大特性</a></h1>
          <p class="handout">作为一款现代的工业级别的图形库, 是还有其他非常多的特性的, 这里给出一个大致的列表:</p>
          <ul class="simple">
          <li>足够多和好用的控件/自定控件/整合到designer中</li>
          <li>webkit/script支持</li>
          <li>强大/方便/快速的绘图控件</li>
          <li>富文本/文本解析</li>
          <li>多国语言支持</li>
          <li>其他第三方控件支持: pyqwt</li>
          </ul>
          <p class="handout">具体有个展示的工具, 如果你安装了qt的话, 可以执行qtdemo, 看看就知道qt能干什么事情了, 并且可以从里面挖出代码来作为参考.</p>
          </div>
          <div class="section" id="id7">
          <h1><a class="toc-backref" href="#id22">发布</a></h1>
          <p><a class="reference external" href="http://www.pyinstaller.org/">pyinstaller</a>!</p>
          <p class="handout">pyinstaller可以完美支持pyqt的打包工作, 不过对于python2.6以上的版本, 需要下载使用开发版本, 这里有 <a class="reference external" href="http://www.pyinstaller.org/wiki/Python26Win">介绍</a>.
          不推荐py2exe, 比较复杂.</p>
          </div>
          <div class="section" id="id9">
          <h1><a class="toc-backref" href="#id23">资源</a></h1>
          <ul>
          <li><dl class="first docutils">
          <dt>PyQt安装</dt>
          <dd><ul class="first last">
          <li><p class="first">ubuntu:</p>
          <pre class="literal-block">
          sudo apt-get install pyqt4-dev-tools
          </pre>
          </li>
          <li><p class="first">windows可以下载一个python包: <a class="reference external" href="http://www.pythonxy.com">pythonxy</a></p>
          </li>
          </ul>
          </dd>
          </dl>
          </li>
          <li><dl class="first docutils">
          <dt>学习材料</dt>
          <dd><ul class="first last simple">
          <li><a class="reference external" href="http://qt.nokia.com/products/">qt</a> 以及 <a class="reference external" href="http://www.riverbankcomputing.co.uk/software/pyqt/intro">pyqt</a> 官方网站</li>
          <li>书籍请google: pyqt book or qt book</li>
          <li>中文资料: <a class="reference external" href="http://www.qteverywhere.com/">qteverywhere</a></li>
          </ul>
          </dd>
          </dl>
          </li>
          </ul>
          </div>
          </div>
          <div class="footer">
          <hr class="footer" />
          PyQt4
          </div>
        </div>
        <div class='time-stamp'>
          <p>建立时间: 2010/11/10 08:59:00</p>
          <p>更新时间: 2010/11/25 13:59:00</p>
        </div>
        <div id='comments'>
          <div id='disqus_thread'>
            <script type="text/javascript">
            (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://halidasvps.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=halidasvps">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
            <script type="text/javascript">
            var disqus_shortname = 'halidasvps';
            (function () {
            var s = document.createElement('script'); s.async = true;
            s.src = 'http://disqus.com/forums/halidasvps/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());
            </script>
          </div>
        </div>
      </div>
      <footer>
        <p>
          @2011 linjunhalida, all right reserved,
          source code <a href="https://github.com/halida/haliblog" target="_blank">here</a>.
        </p>
      </footer>
    </div>
    <div id='return-top-block'>
      <div id='return-top-inner'>
        <a id='return-top' onclick="javascript: $('html,body').animate({scrollTop: 0}, 400);">===></a>
      </div>
    </div>
    <script src="/javascripts/jquery.pjax.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.appear-1.1.1.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js" type="text/javascript"></script>
    <script src="/javascripts/vim.js" type="text/javascript"></script>
    <script type='text/javascript'>
      //<![CDATA[
        (function() {
    
      $(function() {
        init();
        return init_vim_key('#content');
      });
    
    }).call(this);
    
      //]]>
    </script>
    <script type='text/javascript'>
      //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-26509244-1']);
        _gaq.push(['_trackPageview', '_trackPageLoadTime']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      //]]>
    </script>
  </body>
</html>
